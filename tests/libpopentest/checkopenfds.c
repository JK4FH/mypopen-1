/**
 * @file checkopenfds.c
 * Betriebsysteme simple program that exits with EXIT_FAILURE if file descriptors other
 * than stdin, stdout, and stderr are open
 * Beispiel 1.2
 *
 * @author Thomas M. Galla <galla@technikum-wien.at>
 * @date 2013/02/24
 *
 * @version $Revision$
 *
 * @todo Nothing to do. - Everything perfect! ;-)
 *
 * URL: $HeadURL$
 *
 * Last Modified: $Author$
 */

/*
 * -------------------------------------------------------------- includes --
 */

#include <stdio.h>
#include <stdlib.h>
#include <getopt.h>

#include "utils.h"

/*
 * --------------------------------------------------------------- defines --
 */

/*
 * -------------------------------------------------------------- typedefs --
 */

/*
 * --------------------------------------------------------------- globals --
 */

const char *cmd;

/*
 * ------------------------------------------------------------- functions --
 */

void freeresources(
    void
    )
{
}		   

static void usage(
    void
    )
{
    (void) fprintf(stderr, "USAGE: %s [-v]\n", cmd);
    exit(EXIT_FAILURE);
}

int main(
    int argc,
    char *argv[]
    )
{
    int c;

    cmd = argv[0];

    while ((c = getopt(argc, argv, "v")) != EOF)
    {
        switch(c)
        {
        case 'v':
            setVerbose(getVerbose() + 1);
            break;

        default:
            usage();
            break;
        }
    }

    ENTER();

    /* wrong number of arguments? */
    if (argc != optind)
    {
        usage(); /* show usage to user */
    }

    if (!VERIFY_CLOSED_NON_STD_FDS())
    {

        EXIT();
	return EXIT_FAILURE;
    }

    EXIT();
    return EXIT_SUCCESS;
}

/*
 * =================================================================== eof ==
 */

/*
 * Local Variables:
 * c-basic-offset: 4
 * End:
 */
